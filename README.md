
<img width="1920" height="958" alt="{6D3A9562-8E6E-472B-8C82-9D2E8DE63AC6}" src="https://github.com/user-attachments/assets/4cd2322d-f450-409b-af05-74b8c1d6f50b" />




# Write-up: Show_Me Reverse Engineering Challenge

Ù†Ù…Ø§ÛŒ Ú©Ù„ÛŒ Ú†Ø§Ù„Ø´




Ø§ÛŒÙ† ÛŒÚ© Ú†Ø§Ù„Ø´ Ø±ÛŒÙˆØ±Ø³ Ø§Ù†Ø¬ÛŒÙ†ÛŒØ±ÛŒÙ†Ú¯ Ø§Ø³Øª Ú©Ù‡ Ø¯Ø± Ø¢Ù† ÛŒÚ© Ø¨Ø±Ù†Ø§Ù…Ù‡ C ÙˆØ±ÙˆØ¯ÛŒ Ú©Ø§Ø±Ø¨Ø± Ø±Ø§ Ø¯Ø±ÛŒØ§ÙØª Ú©Ø±Ø¯Ù‡ Ùˆ Ø¢Ù† Ø±Ø§ Ø¨Ù‡ ÙØ±Ù…Øª QR Code ØªØ¨Ø¯ÛŒÙ„ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ØŒ Ø³Ù¾Ø³ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø§ÛŒÙ†Ø±ÛŒ QR Code Ø±Ø§ Ø¨Ù‡ Ù‡Ú¯Ø²Ø§Ø¯Ø³ÛŒÙ…Ø§Ù„ ØªØ¨Ø¯ÛŒÙ„ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.


# ØªÙˆØ¶ÛŒØ­ Ú©Ø§Ù…Ù„ ØªØ§Ø¨Ø¹ FUN_00101525 

---
<img width="1717" height="990" alt="{886DB25D-5534-45D4-B27A-5A752215EEF4}" src="https://github.com/user-attachments/assets/8e327dd5-1fe8-4800-bef8-e3a9bb19d47a" />

## ğŸ§  Ù†Ù…Ø§ÛŒ Ú©Ù„ÛŒ

Ø§ÛŒÙ† ØªØ§Ø¨Ø¹ Ù…Ù†Ø·Ù‚ Ø§ØµÙ„ÛŒ Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø§Ø³Øª. ÙˆØ±ÙˆØ¯ÛŒ Ú©Ø§Ø±Ø¨Ø± Ø±Ø§ Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ø¯ØŒ Ø¢Ù† Ø±Ø§ Ù¾Ø¯ÛŒÙ†Ú¯ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ØŒ Ø³Ù¾Ø³ Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² **QR Code** Ø±Ù…Ø²Ú¯Ø°Ø§Ø±ÛŒ Ú©Ø±Ø¯Ù‡ Ùˆ Ø¯Ø± Ù†Ù‡Ø§ÛŒØª Ø®Ø±ÙˆØ¬ÛŒ Ø±Ø§ Ø¨Ù‡ **Ù‡Ú¯Ø²Ø§Ø¯Ø³ÛŒÙ…Ø§Ù„** ØªØ¨Ø¯ÛŒÙ„ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ Ùˆ Ø¯Ø± Ø§Ø¨ØªØ¯Ø§ÛŒ Ø¢Ù† ÛŒÚ© **Salt** ØªØµØ§Ø¯ÙÛŒ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.

Ø¯Ø± Ø§ÛŒÙ† ØªØ­Ù„ÛŒÙ„ØŒ Ù‡Ø± Ø®Ø· Ú©Ø¯ Ø±Ø§ Ø¨Ø§ Ù…Ø«Ø§Ù„ ÙˆØ±ÙˆØ¯ÛŒ:

```
ÙˆØ±ÙˆØ¯ÛŒ Ú©Ø§Ø±Ø¨Ø±: flag
Ø·ÙˆÙ„: Û´ Ú©Ø§Ø±Ø§Ú©ØªØ±
```

Ø¨Ø±Ø±Ø³ÛŒ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ… ØªØ§ Ø¯Ù‚ÛŒÙ‚Ø§Ù‹ Ø¨ÙÙ‡Ù…ÛŒÙ… Ù‡Ø± Ø¨Ø®Ø´ Ú†Ù‡ Ú©Ø§Ø±ÛŒ Ø§Ù†Ø¬Ø§Ù… Ù…ÛŒâ€ŒØ¯Ù‡Ø¯.

---

## ğŸ”¹ Ø¨Ø®Ø´ Û±: ØªØ¹Ø±ÛŒÙ Ù…ØªØºÛŒØ±Ù‡Ø§

```c
undefined8 FUN_00101525(void)
{
  int iVar1;
  time_t tVar2;
  void *__ptr;
  undefined8 uVar3;
  char *pcVar4;
  size_t sVar5;
  long in_FS_OFFSET;
  int local_4b4;
  int local_4b0;
  undefined1 local_498 [849];
  undefined1 local_147 [14];
  undefined1 local_139;
  undefined8 local_138;
  undefined8 local_130;
  undefined1 local_128;
  char local_118 [38];
  undefined1 local_f2;
  long local_10;
```

**ØªÙˆØ¶ÛŒØ­ Ù…ØªØºÛŒØ±Ù‡Ø§:**

| Ù…ØªØºÛŒØ±                                 | ØªÙˆØ¶ÛŒØ­                        |
| ------------------------------------- | ---------------------------- |
| `local_498[849]`                      | Ø°Ø®ÛŒØ±Ù‡ QR code (Ù…Ø§ØªØ±ÛŒØ³ 29Ã—29) |
| `local_147[14]`                       | Ø±Ø´ØªÙ‡ ØªØµØ§Ø¯ÙÛŒ Salt             |
| `local_138`, `local_130`, `local_128` | Ø¬Ø¯ÙˆÙ„ Ú©Ø§Ø±Ø§Ú©ØªØ±Ù‡Ø§ÛŒ hex          |
| `local_118[38]`                       | Ø¨Ø§ÙØ± ÙˆØ±ÙˆØ¯ÛŒ Ú©Ø§Ø±Ø¨Ø±             |
| `local_4b4`, `local_4b0`              | Ø´Ù…Ø§Ø±Ù†Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø­Ù„Ù‚Ù‡             |

---

## ğŸ”¹ Ø¨Ø®Ø´ Û²: Ù…Ø­Ø§ÙØ¸Øª Ø§Ø² Stack (Stack Canary)

```c
local_10 = *(long *)(in_FS_OFFSET + 0x28);
```

Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø­Ù…Ù„Ø§Øª **buffer overflow** Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯. Ø¯Ø± Ù¾Ø§ÛŒØ§Ù† Ø¨Ø±Ø±Ø³ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯.

---

## ğŸ”¹ Ø¨Ø®Ø´ Û³: Ø³Ø§Ø®Øª Ø¬Ø¯ÙˆÙ„ Ú©Ø§Ø±Ø§Ú©ØªØ±Ù‡Ø§ÛŒ Hex

```c
local_138 = 0x3736353433323130;
local_130 = 0x6665646362613938;
local_128 = 0;
```

Ø¨Ø§ Ø¯Ø± Ù†Ø¸Ø± Ú¯Ø±ÙØªÙ† Little-Endian:

```
hex_chars = "0123456789abcdef"
```

---

## ğŸ”¹ Ø¨Ø®Ø´ Û´: ØªÙˆÙ„ÛŒØ¯ Salt ØªØµØ§Ø¯ÙÛŒ

```c
tVar2 = time((time_t *)0x0);
srand((uint)tVar2);
```

ÙØ±Ø¶ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ… `time()` Ù…Ù‚Ø¯Ø§Ø± `1727654400` Ø¨Ø±Ú¯Ø±Ø¯Ø§Ù†Ø¯. Ø³Ù¾Ø³ Ø¨Ø§ Ø§ÛŒÙ† Ù…Ù‚Ø¯Ø§Ø± RNG Ø±Ø§ seed Ù…ÛŒâ€ŒÚ©Ù†Ø¯.

Ø­Ù„Ù‚Ù‡ ØªÙˆÙ„ÛŒØ¯ Salt:

```c
for (local_4b4 = 0; local_4b4 < 0xe; local_4b4++) {
  iVar1 = rand();
  local_147[local_4b4] = *(undefined1 *)((long)&local_138 + (long)(iVar1 % 0x10));
}
local_139 = 0;
```

### ğŸ”¢ Ù†ØªÛŒØ¬Ù‡ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Salt

| i  | rand()     | %16 | Ú©Ø§Ø±Ø§Ú©ØªØ± |
| -- | ---------- | --- | ------- |
| 0  | 846930886  | 6   | '6'     |
| 1  | 1681692777 | 9   | '9'     |
| 2  | 1714636915 | 3   | '3'     |
| 3  | 1957747793 | 1   | '1'     |
| 4  | 424238335  | 15  | 'f'     |
| 5  | 719885386  | 10  | 'a'     |
| 6  | 1649760492 | 12  | 'c'     |
| 7  | 596516649  | 9   | '9'     |
| 8  | 1189641421 | 13  | 'd'     |
| 9  | 1025202362 | 10  | 'a'     |
| 10 | 1350490027 | 11  | 'b'     |
| 11 | 783368690  | 2   | '2'     |
| 12 | 1495764371 | 3   | '3'     |
| 13 | 1894536430 | 14  | 'e'     |

ğŸ“¦ **Salt Ù†Ù‡Ø§ÛŒÛŒ:** `6931fac9dab23e`

---

## ğŸ”¹ Ø¨Ø®Ø´ Ûµ: ØªØ®ØµÛŒØµ Ø­Ø§ÙØ¸Ù‡

```c
__ptr = malloc(0xe9);
```

ğŸ”¸ `0xE9 = 233 Ø¨Ø§ÛŒØª`

Ø¯Ù„ÛŒÙ„: `29 Ã— 8 = 232` Ú©Ø§Ø±Ø§Ú©ØªØ± Ù‡Ú¯Ø² + Û± Ø¨Ø§ÛŒØª Ø¨Ø±Ø§ÛŒ Null Terminator.

---

## ğŸ”¹ Ø¨Ø®Ø´ Û¶: Ø¯Ø±ÛŒØ§ÙØª ÙˆØ±ÙˆØ¯ÛŒ Ú©Ø§Ø±Ø¨Ø±

```c
printf("Enter secret text: ");
pcVar4 = fgets(local_118, 0x100, stdin);
```

ÙˆØ±ÙˆØ¯ÛŒ Ú©Ø§Ø±Ø¨Ø±:

```
flag\n
```

Ù¾Ø³ Ø§Ø² ÙˆØ±ÙˆØ¯:

```
local_118 = { 'f', 'l', 'a', 'g', '\n', '\0' }
```

---

## ğŸ”¹ Ø¨Ø®Ø´ Û·: Ø­Ø°Ù Ú©Ø§Ø±Ø§Ú©ØªØ± Newline

```c
sVar5 = strcspn(local_118, "\n");
local_118[sVar5] = '\0';
```

Ù†ØªÛŒØ¬Ù‡:

```
local_118 = "flag"
```

---

## ğŸ”¹ Ø¨Ø®Ø´ Û¸: Ø¨Ø±Ø±Ø³ÛŒ Ø®Ø§Ù„ÛŒ Ø¨ÙˆØ¯Ù† ÙˆØ±ÙˆØ¯ÛŒ

Ø§Ú¯Ø± ÙˆØ±ÙˆØ¯ÛŒ Ø®Ø§Ù„ÛŒ Ø¨Ø§Ø´Ø¯ Ø¨Ø±Ù†Ø§Ù…Ù‡ Ù…ØªÙˆÙ‚Ù Ù…ÛŒâ€ŒØ´ÙˆØ¯ â€” Ø¯Ø± Ø§ÛŒÙ† Ù…Ø«Ø§Ù„ Ø§Ø¯Ø§Ù…Ù‡ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯.

---

## ğŸ”¹ Ø¨Ø®Ø´ Û¹: Padding ØªØ§ Ø·ÙˆÙ„ Û³Û¸ Ú©Ø§Ø±Ø§Ú©ØªØ±

```c
sVar5 = strlen(local_118);  // sVar5 = 4
local_4b0 = (int)sVar5;

if (local_4b0 < 0x26) {
  for (; local_4b0 < 0x26; local_4b0++) {
    if (local_4b0 % 3 == 0) local_118[local_4b0] = '*';
    else if (local_4b0 % 3 == 1) local_118[local_4b0] = '+';
    else local_118[local_4b0] = '-';
  }
}
```

Ù†ØªÛŒØ¬Ù‡ Ù†Ù‡Ø§ÛŒÛŒ:

```
flag+-*+-*+-*+-*+-*+-*+-*+-*+-*+-*+-*+
```

Ø·ÙˆÙ„: Û³Û¸ Ú©Ø§Ø±Ø§Ú©ØªØ± âœ…

---

## ğŸ”¹ Ø¨Ø®Ø´ Û±Û°: ØªØ¨Ø¯ÛŒÙ„ Ø±Ø´ØªÙ‡ Ø¨Ù‡ QR Code

```c
FUN_00101329(local_118, local_498);
```

Ø±Ø´ØªÙ‡ Ø±Ø§ Ø¨Ù‡ **Ù…Ø§ØªØ±ÛŒØ³ QR 29Ã—29** ØªØ¨Ø¯ÛŒÙ„ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.

---

## ğŸ”¹ Ø¨Ø®Ø´ Û±Û±: ØªØ¨Ø¯ÛŒÙ„ QR Ø¨Ù‡ Hexadecimal

```c
FUN_00101454(local_498, __ptr);
```

Ù…Ø«Ø§Ù„ Ø®Ø±ÙˆØ¬ÛŒ:

```
__ptr = "feeb53f882e2f208ba..."
```

---

## ğŸ”¹ Ø¨Ø®Ø´ Û±Û²: Ú†Ø§Ù¾ Ø®Ø±ÙˆØ¬ÛŒ Ù†Ù‡Ø§ÛŒÛŒ

```c
printf("Ciphertext: \n%s%s\n", local_147, __ptr);
```

ğŸ“œ Ø®Ø±ÙˆØ¬ÛŒ:

```
Ciphertext:
6931fac9dab23efeeb53f882e2f208ba...
```

```
â”Œâ”€â”€â”€â”€Saltâ”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€QRâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
6931fac9dab23e feeb53f882e2f208ba...
```

---

## ğŸ”¹ Ø¨Ø®Ø´ Û±Û³: Ø¢Ø²Ø§Ø¯Ø³Ø§Ø²ÛŒ Ø­Ø§ÙØ¸Ù‡ Ùˆ Ø¨Ø±Ø±Ø³ÛŒ Stack Canary

```c
free(__ptr);
return 0;
```

---

## âœ… Ø®Ù„Ø§ØµÙ‡ Ø¹Ù…Ù„Ú©Ø±Ø¯ ØªØ§Ø¨Ø¹ (Ø¨Ø§ Ù…Ø«Ø§Ù„ `flag`)

| Ù…Ø±Ø­Ù„Ù‡ | ØªÙˆØ¶ÛŒØ­               | Ù†ØªÛŒØ¬Ù‡                                 |
| ----- | ------------------- | ------------------------------------- |
| Û±     | ØªÙˆÙ„ÛŒØ¯ Salt          | `6931fac9dab23e`                      |
| Û²     | Ø¯Ø±ÛŒØ§ÙØª ÙˆØ±ÙˆØ¯ÛŒ        | `flag`                                |
| Û³     | Ø­Ø°Ù \n              | `flag`                                |
| Û´     | Ù¾Ø¯ÛŒÙ†Ú¯ ØªØ§ Û³Û¸ Ú©Ø§Ø±Ø§Ú©ØªØ± | `flag+-*+-*+-*+...`                   |
| Ûµ     | Ø³Ø§Ø®Øª QR Code        | Ù…Ø§ØªØ±ÛŒØ³ Û²Û¹Ã—Û²Û¹                          |
| Û¶     | ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ Hex        | `feeb53f882e2f208ba...`               |
| Û·     | ØªØ±Ú©ÛŒØ¨ Salt + QR     | `6931fac9dab23efeeb53f882e2f208ba...` |

ğŸ“¦ **Ø®Ø±ÙˆØ¬ÛŒ Ù†Ù‡Ø§ÛŒÛŒ:**

```
6931fac9dab23efeeb53f882e2f208ba...
```

---






```c
1   void FUN_00101329(char *param_1, undefined1 *param_2)
2   {
3     int iVar1;
4     uint uVar2;
5     QRcode *pQVar3;
6     long in_FS_OFFSET;
7     int local_34;
8     int local_30;
9     long local_10;
10    
11    local_10 = *(long *)(in_FS_OFFSET + 0x28);
12    pQVar3 = QRcode_encodeString(param_1, 0, QR_ECLEVEL_L, QR_MODE_8, 1);
13    if (pQVar3 == (QRcode *)0x0) {
14      fwrite("QR encoding failed\n", 1, 0x13, stderr);
15      exit(1);
16    }
17    uVar2 = pQVar3->width;
18    memset(param_2, 0, (long)(int)uVar2 * (long)(int)uVar2);
19    for (local_34 = 0; local_34 < (int)pQVar3->width; local_34 = local_34 + 1) {
20      for (local_30 = 0; local_30 < (int)pQVar3->width; local_30 = local_30 + 1) {
21        iVar1 = local_34 * (int)pQVar3->width + local_30;
22        param_2[local_34 * (int)pQVar3->width + local_30] =
23            (undefined1)((uint)pQVar3->data[iVar1] & 1);
24      }
25    }
26    QRcode_free(pQVar3);
27    if (local_10 != *(long *)(in_FS_OFFSET + 0x28)) {
28      __stack_chk_fail();
29    }
30    return;
31  }
```

ÙˆØ±ÙˆØ¯ÛŒ Ù…Ø«Ø§Ù„ Ù…Ø§:

```c
input_string = "flag+-*+-*+-*+-*+-*+-*+-*+-*+-*+-*+-*+"
length = 38 characters
```

Ø®Ø·ÙˆØ· 3-9: ØªØ¹Ø±ÛŒÙ Ù…ØªØºÛŒØ±Ù‡Ø§

```c
int iVar1;           // Ù…ØªØºÛŒØ± Ù…ÙˆÙ‚Øª Ø¨Ø±Ø§ÛŒ Ù…Ø­Ø§Ø³Ø¨Ù‡ index
uint uVar2;          // Ø¨Ø±Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ width Ù…Ø§ØªØ±ÛŒØ³ QR
QRcode *pQVar3;      // pointer Ø¨Ù‡ Ø³Ø§Ø®ØªØ§Ø± QRcode
long in_FS_OFFSET;   // offset Ø¨Ø±Ø§ÛŒ stack canary
int local_34;        // counter Ø³Ø·Ø±Ù‡Ø§ (row)
int local_30;        // counter Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ (column)
long local_10;       // Ù…Ù‚Ø¯Ø§Ø± canary
```

ØªÙˆØ¶ÛŒØ­ Ù‡Ø± Ù…ØªØºÛŒØ±:

** QRcode *pQVar3: **

Ø§ÛŒÙ† ÛŒÚ© pointer Ø¨Ù‡ Ø³Ø§Ø®ØªØ§Ø± Ø²ÛŒØ± Ø§Ø³Øª:

```c
typedef struct {
    int version;        // Ù†Ø³Ø®Ù‡ QR (1 ØªØ§ 40)
    int width;          // Ø¹Ø±Ø¶/Ø§Ø±ØªÙØ§Ø¹ Ù…Ø§ØªØ±ÛŒØ³
    unsigned char *data; // Ø¢Ø±Ø§ÛŒÙ‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ QR
} QRcode;
```

Ù…Ø«Ø§Ù„:

```c
pQVar3->version = 3      // Ù†Ø³Ø®Ù‡ 3
pQVar3->width = 29       // Ù…Ø§ØªØ±ÛŒØ³ 29Ã—29
pQVar3->data = [841 bytes]  // 29Ã—29 = 841
```

**in_FS_OFFSET:**

Ø§ÛŒÙ† Ù…Ù‚Ø¯Ø§Ø± Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Stack Canary Ø§Ø³Øª Ú©Ù‡ Ø¨Ø±Ø§ÛŒ Ø§Ù…Ù†ÛŒØª Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.


Ø®Ø· 11: Stack Canary Initialization

```c
local_10 = *(long *)(in_FS_OFFSET + 0x28);
```

ØªÙˆØ¶ÛŒØ­ Ú©Ø§Ù…Ù„:

Memory Layout:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FS Segment         â”‚
â”‚ â€¦                  â”‚
â”‚ +0x28: canary      â”‚ â† ÛŒÚ© Ù…Ù‚Ø¯Ø§Ø± ØªØµØ§Ø¯ÙÛŒ
â”‚ â€¦                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

`local_10` = Ø§ÛŒÙ† Ù…Ù‚Ø¯Ø§Ø± Ø±Ø§ Ú©Ù¾ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.

**Ù‡Ø¯Ù:** Ø¯Ø± Ù¾Ø§ÛŒØ§Ù† ØªØ§Ø¨Ø¹ØŒ Ø§ÛŒÙ† Ù…Ù‚Ø¯Ø§Ø± Ú†Ú© Ù…ÛŒâ€ŒØ´ÙˆØ¯. Ø§Ú¯Ø± ØªØºÛŒÛŒØ± Ú©Ø±Ø¯Ù‡ Ø¨Ø§Ø´Ø¯ ÛŒØ¹Ù†ÛŒ buffer overflow Ø±Ø® Ø¯Ø§Ø¯Ù‡!

---

Ø®Ø· 12: ØªÙˆÙ„ÛŒØ¯ QR Code â­ **Ù…Ù‡Ù…ØªØ±ÛŒÙ† Ø®Ø·**

```c
pQVar3 = QRcode_encodeString(param_1, 0, QR_ECLEVEL_L, QR_MODE_8, 1);
```

ØªØ­Ù„ÛŒÙ„ Ù‡Ø± Ù¾Ø§Ø±Ø§Ù…ØªØ±:

**Ù¾Ø§Ø±Ø§Ù…ØªØ± 1:** `param_1` (ÙˆØ±ÙˆØ¯ÛŒ)

```c
"flag+-*+-*+-*+-*+-*+-*+-*+-*+-*+-*+-*+"
```

**Ù¾Ø§Ø±Ø§Ù…ØªØ± 2:** `0` (Version - Auto)

QR Code Ù†Ø³Ø®Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„ÙÛŒ Ø¯Ø§Ø±Ø¯:

| Version | Size    | Max Characters (Alphanumeric) |
| ------- | ------- | ----------------------------- |
| 1       | 21Ã—21   | 25                            |
| 2       | 25Ã—25   | 47                            |
| 3       | 29Ã—29   | 77                            |
| 4       | 33Ã—33   | 114                           |
| â€¦       | â€¦       | â€¦                             |
| 40      | 177Ã—177 | 4296                          |

ÙØ±Ù…ÙˆÙ„ Size:

```
Size = 17 + 4 Ã— Version
```

Ù…Ø«Ø§Ù„:

* Version 1: 17 + 4Ã—1 = 21
* Version 2: 17 + 4Ã—2 = 25
* Version 3: 17 + 4Ã—3 = 29

Ø¨Ø±Ø§ÛŒ 38 Ú©Ø§Ø±Ø§Ú©ØªØ± Ù…Ø§ØŒ Version 3 (29Ã—29) Ø§Ù†ØªØ®Ø§Ø¨ Ù…ÛŒâ€ŒØ´ÙˆØ¯.

**Ù¾Ø§Ø±Ø§Ù…ØªØ± 3:** `QR_ECLEVEL_L` (Error Correction Level)

Ú†Ù‡Ø§Ø± Ø³Ø·Ø­ ØªØµØ­ÛŒØ­ Ø®Ø·Ø§ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯:

| Level        | Recovery Capacity | Data Capacity | Use Case           |
| ------------ | ----------------- | ------------- | ------------------ |
| L (Low)      | ~7%               | Maximum       | Clean environments |
| M (Medium)   | ~15%              | High          | Normal use         |
| Q (Quartile) | ~25%              | Medium        | Outdoor            |
| H (High)     | ~30%              | Low           | Damaged/dirty      |

Ù…Ø«Ø§Ù„ Ø¹Ù…Ù„ÛŒ:

ÙØ±Ø¶ Ú©Ù†ÛŒÙ… QR Code Ø¯Ø§Ø±Ø§ÛŒ 100 Ø¨Ø§ÛŒØª Ø¯Ø§Ø¯Ù‡ Ø§Ø³Øª:

* Level L: Ø§Ú¯Ø± 7 Ø¨Ø§ÛŒØª Ø¢Ø³ÛŒØ¨ Ø¨Ø¨ÛŒÙ†Ø¯ØŒ Ù‚Ø§Ø¨Ù„ ØªØ±Ù…ÛŒÙ… Ø§Ø³Øª
* Level H: Ø§Ú¯Ø± 30 Ø¨Ø§ÛŒØª Ø¢Ø³ÛŒØ¨ Ø¨Ø¨ÛŒÙ†Ø¯ØŒ Ù‚Ø§Ø¨Ù„ ØªØ±Ù…ÛŒÙ… Ø§Ø³Øª

Ø§Ù…Ø§:

* Level L: Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ 100 Ø¨Ø§ÛŒØª Ø¯Ø§Ø¯Ù‡ Ø°Ø®ÛŒØ±Ù‡ Ú©Ù†Ø¯
* Level H: ÙÙ‚Ø· Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ ~70 Ø¨Ø§ÛŒØª Ø¯Ø§Ø¯Ù‡ Ø°Ø®ÛŒØ±Ù‡ Ú©Ù†Ø¯

**Ù¾Ø§Ø±Ø§Ù…ØªØ± 4:** `QR_MODE_8` (Encoding Mode)

Ú†Ù†Ø¯ Ø­Ø§Ù„Øª Ú©Ø¯Ú¯Ø°Ø§Ø±ÛŒ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯:

| Mode         | Description       | Bits per Character | Example  |
| ------------ | ----------------- | ------------------ | -------- |
| Numeric      | ÙÙ‚Ø· Ø§Ø¹Ø¯Ø§Ø¯ 0-9     | 3.33 bits          | "123456" |
| Alphanumeric | 0-9, A-Z, symbols | 5.5 bits           | "HELLO"  |
| Byte (8-bit) | Ù‡Ø± Ø¨Ø§ÛŒØª           | 8 bits             | "flagÂ±*" |
| Kanji        | Ú©Ø§Ø±Ø§Ú©ØªØ±Ù‡Ø§ÛŒ Ú˜Ø§Ù¾Ù†ÛŒ  | 13 bits            | "æ—¥æœ¬"     |

Ú†Ø±Ø§ **MODE_8**ØŸ

```c
"flag+-*+-*..."
 â†‘    â†‘â†‘
 Ø­Ø±ÙˆÙ  Ú©Ø§Ø±Ø§Ú©ØªØ±Ù‡Ø§ÛŒ Ø®Ø§Øµ
```

Ù†ÛŒØ§Ø² Ø¨Ù‡ Byte mode Ø¯Ø§Ø±ÛŒÙ… Ú†ÙˆÙ† Ú©Ø§Ø±Ø§Ú©ØªØ±Ù‡Ø§ÛŒ ASCII Ù…Ø¹Ù…ÙˆÙ„ÛŒ + ÙˆÛŒÚ˜Ù‡ Ø¯Ø§Ø±ÛŒÙ….

**Ù¾Ø§Ø±Ø§Ù…ØªØ± 5:** `1` (Case Sensitive)

```c
1 = Case Sensitive (Ø­Ø³Ø§Ø³ Ø¨Ù‡ Ø­Ø±ÙˆÙ Ø¨Ø²Ø±Ú¯/Ú©ÙˆÚ†Ú©)
0 = Case Insensitive
```

Ù…Ø«Ø§Ù„:

* `"Flag"` â‰  `"flag"`  (Ø¨Ø§ 1)
* `"Flag"` = `"flag"`  (Ø¨Ø§ 0)




Ø¬Ø±ÛŒØ§Ù† Ø¯Ø±ÙˆÙ†ÛŒ QRcode_encodeString:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

â”‚ 1. ØªØ­Ù„ÛŒÙ„ ÙˆØ±ÙˆØ¯ÛŒ Ùˆ Ø§Ù†ØªØ®Ø§Ø¨ Mode â”‚

â”‚ â€œflagÂ±*â€¦â€ â†’ Byte Mode â”‚

â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â†“

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

â”‚ 2. Ù…Ø­Ø§Ø³Ø¨Ù‡ Version Ù…Ù†Ø§Ø³Ø¨ â”‚

â”‚ 38 chars â†’ Version 3 (29Ã—29) â”‚

â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â†“

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

â”‚ 3. ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ Binary Stream â”‚

â”‚ â€œflagâ€ â†’ 01100110 01101100â€¦ â”‚

â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â†“

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

â”‚ 4. Ø§ÙØ²ÙˆØ¯Ù† Error Correction Codes â”‚

â”‚ Reed-Solomon Algorithm â”‚

â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â†“

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

â”‚ 5. Ù‚Ø±Ø§Ø± Ø¯Ø§Ø¯Ù† Ø¯Ø± Ù…Ø§ØªØ±ÛŒØ³ â”‚

â”‚ Masking, Patterns, etc. â”‚

â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â†“

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

â”‚ Ù†ØªÛŒØ¬Ù‡: Ù…Ø§ØªØ±ÛŒØ³ 29Ã—29 â”‚

â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

Ø®Ø·ÙˆØ· 13-16: Ø¨Ø±Ø±Ø³ÛŒ Ø®Ø·Ø§

```c
if (pQVar3 == (QRcode *)0x0) {
    fwrite("QR encoding failed\n", 1, 0x13, stderr);
    exit(1);
}
```

**Ú†Ù‡ Ø²Ù…Ø§Ù†ÛŒ NULL Ø¨Ø±Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø¯ØŸ**

* Ø­Ø§ÙØ¸Ù‡ Ú©Ø§ÙÛŒ Ù†ÛŒØ³Øª (malloc failed)
* ÙˆØ±ÙˆØ¯ÛŒ Ø®ÛŒÙ„ÛŒ Ø¨Ø²Ø±Ú¯ Ø§Ø³Øª (Ø¨ÛŒØ´ Ø§Ø² Version 40)
* Ú©Ø§Ø±Ø§Ú©ØªØ±Ù‡Ø§ÛŒ Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø¯Ø± ÙˆØ±ÙˆØ¯ÛŒ

**Ù…Ø«Ø§Ù„:**

```c
// ÙˆØ±ÙˆØ¯ÛŒ 3000 Ú©Ø§Ø±Ø§Ú©ØªØ±ÛŒ
char huge[3000];
QRcode_encodeString(huge, ...) â†’ NULL (Ø®ÛŒÙ„ÛŒ Ø¨Ø²Ø±Ú¯!)
```

---

Ø®Ø· 17: Ø°Ø®ÛŒØ±Ù‡ Width

```c
uVar2 = pQVar3->width;
```

**Ø¨Ø±Ø§ÛŒ Ù…Ø«Ø§Ù„ Ù…Ø§:**

```c
uVar2 = 29  // Ù…Ø§ØªØ±ÛŒØ³ 29Ã—29
```

---

Ø®Ø· 18: Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ø¢Ø±Ø§ÛŒÙ‡ Ø®Ø±ÙˆØ¬ÛŒ

```c
memset(param_2, 0, (long)(int)uVar2 * (long)(int)uVar2);
```

**Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¯Ù‚ÛŒÙ‚:**

```c
width = 29
size = 29 Ã— 29 = 841 bytes

memset(param_2, 0, 841)
```

**Ø¹Ù…Ù„ÛŒØ§Øª:**

Ù‚Ø¨Ù„ Ø§Ø² memset:

param_2 = [garbage, garbage, garbage, â€¦]

Ø¨Ø¹Ø¯ Ø§Ø² memset:

param_2 = [0, 0, 0, 0, 0, â€¦, 0] (841 zero)



Ø®Ø·ÙˆØ· 19-25: Ø­Ù„Ù‚Ù‡â€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ â­

```c
for (local_34 = 0; local_34 < (int)pQVar3->width; local_34 = local_34 + 1) {
    for (local_30 = 0; local_30 < (int)pQVar3->width; local_30 = local_30 + 1) {
        iVar1 = local_34 * (int)pQVar3->width + local_30;
        param_2[local_34 * (int)pQVar3->width + local_30] =
            (undefined1)((uint)pQVar3->data[iVar1] & 1);
    }
}
```

Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ú©Ø§Ù…Ù„ Ø¨Ø§ Ù…Ø§ØªØ±ÛŒØ³ ÙˆØ§Ù‚Ø¹ÛŒ:

ÙØ±Ø¶ Ú©Ù†ÛŒÙ… QR Ú©ÙˆÚ†Ú© 5Ã—5 Ø¯Ø§Ø±ÛŒÙ…:

QR Matrix (5Ã—5):

Col 0 1 2 3 4

Row â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

0 â”‚ 1 1 1 0 0 â”‚

1 â”‚ 1 0 0 1 1 â”‚

2 â”‚ 1 0 1 0 1 â”‚

3 â”‚ 0 1 1 1 0 â”‚

4 â”‚ 0 1 0 0 1 â”‚

â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Ù†Ù…Ø§ÛŒØ´ Ø¯Ø± pQVar3->data:

Index: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24

Value: 1 1 1 0 0 1 0 0 1 1 1 0 1 0 1 0 1 1 1 0 0 1 0 0 1

Row: |â† Row 0 â†’| |â† Row 1 â†’| |â† Row 2 â†’| |â† Row 3 â†’| |â† Row 4 â†’|

Ø­Ù„Ù‚Ù‡ iteration by iteration:
Iteration 1: row=0, col=0

```c
local_34 = 0  (row)
local_30 = 0  (col)

iVar1 = 0 * 5 + 0 = 0

param_2[0] = pQVar3->data[0] & 1
           = 1 & 1
           = 1
```

param_2:

â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”

â”‚ 1 â”‚ ? â”‚ ? â”‚ ? â”‚ ? â”‚

â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜

â†‘

filled

Iteration 2: row=0, col=1

```c
local_34 = 0
local_30 = 1

iVar1 = 0 * 5 + 1 = 1

param_2[1] = pQVar3->data[1] & 1
           = 1 & 1
           = 1
```

Iteration 3-5: row=0, col=2,3,4

```c
param_2[2] = data[2] & 1 = 1
param_2[3] = data[3] & 1 = 0
param_2[4] = data[4] & 1 = 0
```

Ø¨Ø¹Ø¯ Ø§Ø² ØªÙ…Ø§Ù… Ø´Ø¯Ù† Ø³Ø·Ø± 0:

param_2:

â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”

â”‚ 1 â”‚ 1 â”‚ 1 â”‚ 0 â”‚ 0 â”‚ ? â”‚ â€¦

â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜

â””â”€â”€â”€â”€â”€Row 0â”€â”€â”€â”€â”€â”˜

Iteration 6: row=1, col=0

```c
local_34 = 1
local_30 = 0

iVar1 = 1 * 5 + 0 = 5

param_2[5] = pQVar3->data[5] & 1
           = 1 & 1
           = 1
```

Ø§Ø¯Ø§Ù…Ù‡ ØªØ§ Ù¾Ø§ÛŒØ§Ù†â€¦

```c
Iteration  Row Col  Index  Value
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    1       0   0     0      1
    2       0   1     1      1
    3       0   2     2      1
    4       0   3     3      0
    5       0   4     4      0
    6       1   0     5      1
    7       1   1     6      0
    8       1   2     7      0
    9       1   3     8      1
   10       1   4     9      1
   11       2   0    10      1
    ...
   25       4   4    24      1
```

Ù†ØªÛŒØ¬Ù‡ Ù†Ù‡Ø§ÛŒÛŒ param_2:

<img width="1202" height="153" alt="{3884F1BC-8247-414E-BB11-69493E54142F}" src="https://github.com/user-attachments/assets/6edff912-139c-401b-be84-068e90ab6030" />


Ø¹Ù…Ù„ÛŒØ§Øª & 1 Ú†ÛŒØ³ØªØŸ
pQVar3->data[i] Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ù…Ù‚Ø§Ø¯ÛŒØ± Ù…Ø®ØªÙ„ÙÛŒ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯:

Ù…Ø«Ø§Ù„ 1:

data[i] = 0x00 (0000 0000)

& 0x01 (0000 0001)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

0x00 (0000 0000) â†’ 0 (white)

Ù…Ø«Ø§Ù„ 2:

data[i] = 0x01 (0000 0001)

& 0x01 (0000 0001)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

0x01 (0000 0001) â†’ 1 (black)

Ù…Ø«Ø§Ù„ 3:

data[i] = 0xFF (1111 1111)

& 0x01 (0000 0001)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

0x01 (0000 0001) â†’ 1 (black)

Ù†ØªÛŒØ¬Ù‡: ÙÙ‚Ø· Ø¨ÛŒØª Ú©Ù…â€ŒØ§Ø±Ø²Ø´ (LSB) Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…ÛŒâ€ŒØ´ÙˆØ¯.
Ø¨Ø±Ø§ÛŒ Ù…Ø§ØªØ±ÛŒØ³ 29Ã—29 ÙˆØ§Ù‚Ø¹ÛŒ:

```c
Total iterations = 29 Ã— 29 = 841

Row  0: param_2[0..28]   = 29 bytes
Row  1: param_2[29..57]  = 29 bytes
Row  2: param_2[58..86]  = 29 bytes
...
Row 28: param_2[812..840]= 29 bytes
```

**Formula:**

```python
def get_pixel(row, col):
    index = row * 29 + col
    return param_2[index]

# Ù…Ø«Ø§Ù„:
pixel_at_10_15 = param_2[10 * 29 + 15]
                = param_2[305]
```

---

Ø®Ø· 26: Ø¢Ø²Ø§Ø¯Ø³Ø§Ø²ÛŒ Ø­Ø§ÙØ¸Ù‡

```c
QRcode_free(pQVar3);
```

**Ú†Ø±Ø§ Ù„Ø§Ø²Ù… Ø§Ø³ØªØŸ**

```c
QRcode_encodeString() {
    QRcode *qr = malloc(sizeof(QRcode));
    qr->data = malloc(width * width);
    ...
    return qr;  // Ø­Ø§ÙØ¸Ù‡ allocated Ø´Ø¯Ù‡ Ø¨Ø±Ú¯Ø´Øª Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
}
```

Ø§Ú¯Ø± `QRcode_free` ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ Ù†Ø´ÙˆØ¯ â†’ **Memory Leak!**

Ø¨Ø¯ÙˆÙ† free:

* Iteration 1: 841 bytes leaked
* Iteration 2: 841 bytes leaked
* Iteration 3: 841 bytes leaked
* â€¦
* After 1000 calls: 841 KB leaked!

---

Ø®Ø·ÙˆØ· 27-29: Stack Canary Check

```c
if (local_10 != *(long *)(in_FS_OFFSET + 0x28)) {
    __stack_chk_fail();
}
```

Ú†Ú© Ù…ÛŒâ€ŒÚ©Ù†Ø¯:

* Ø§Ø¨ØªØ¯Ø§ÛŒ ØªØ§Ø¨Ø¹: local_10 = 0xDEADBEEFCAFEBABE (Ù…Ù‚Ø¯Ø§Ø± ØªØµØ§Ø¯ÙÛŒ)
* Ø§Ù†ØªÙ‡Ø§ÛŒ ØªØ§Ø¨Ø¹: canary = 0xDEADBEEFCAFEBABE ØŸ

Ø§Ú¯Ø± YES â†’ Ù‡Ù…Ù‡ Ú†ÛŒØ² OK
Ø§Ú¯Ø± NO â†’ Buffer overflow! â†’ CRASH

**Ù…Ø«Ø§Ù„ Buffer Overflow:**

```c
char buffer[10];
strcpy(buffer, "Ø§ÛŒÙ† Ø±Ø´ØªÙ‡ Ø®ÛŒÙ„ÛŒ Ø¨Ù„Ù†Ø¯ Ø§Ø³Øª!");  // Overflow!
```

* canary Ø¢Ø³ÛŒØ¨ Ù…ÛŒâ€ŒØ¨ÛŒÙ†Ø¯
* `__stack_chk_fail()` ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯
* Ø¨Ø±Ù†Ø§Ù…Ù‡ crash Ù…ÛŒâ€ŒÚ©Ù†Ø¯

---



# Step 3: ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ Hex (ØªØ§Ø¨Ø¹ FUN_00101454)

Ø§ÛŒÙ† Ù‚Ù„Ø¨ Ø§ØµÙ„ÛŒ Ø±Ù…Ø²Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø³Øª!

## Ú©Ø¯ Ú©Ø§Ù…Ù„

```c
void FUN_00101454(byte *qr_matrix, char *hex_output) {
    uint uVar1;
    byte bVar2;
    int row;
    int bit_index;
    
    for (row = 0; row < 29; row = row + 1) {
        uVar1 = 0;  // Ø¬Ù…Ø¹â€ŒÚ©Ù†Ù†Ø¯Ù‡ 8-bit
        
        for (bit_index = 0; bit_index < 8; bit_index = bit_index + 1) {
            if (bit_index < 5) {
                bVar2 = qr_matrix[bit_index * 29 + row];  // ØªÙˆØ¬Ù‡: transpose!
            }
            else {
                bVar2 = 0;  // padding Ø¨Ø§ 0
            }
            uVar1 = uVar1 << 1 | (uint)bVar2;
        }
        
        sprintf(hex_output + row * 2, "%02x", (ulong)uVar1);
    }
    
    hex_output[58] = '\0';
}
```

## Ø¯Ø±Ú© Ø¹Ù…ÛŒÙ‚ Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ…

### Ù†Ú©ØªÙ‡ Ú©Ù„ÛŒØ¯ÛŒ: Transpose!

```c
qr_matrix[bit_index * 29 + row]
```

Ø§ÛŒÙ† Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ Ø±Ø§ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù†Ø¯ØŒ Ù†Ù‡ Ø³Ø·Ø±Ù‡Ø§!

Ù…Ø¹Ø§Ø¯Ù„:

```python
value = qr_matrix[column][row]  # transpose of normal indexing
```

## Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ú©Ø§Ù…Ù„ Ø¨Ø§ Ù…Ø«Ø§Ù„

ÙØ±Ø¶ Ú©Ù†ÛŒÙ… Ø¨Ø®Ø´ Ú©ÙˆÚ†Ú©ÛŒ Ø§Ø² QR:

QR Matrix (29Ã—29):

```
Col0 Col1 Col2 Col3 Col4
Row0: 1 0 1 1 0
Row1: 0 1 0 1 1
Row2: 1 1 1 0 0
Row3: 0 0 1 1 1
Row4: 1 1 0 0 1
...
```

### Ù¾Ø±Ø¯Ø§Ø²Ø´ Row 0

```python
row = 0
uVar1 = 0b00000000

# bit_index = 0
bVar2 = qr_matrix[0*29 + 0] = qr_matrix[0]   # Row0, Col0 = 1
uVar1 = (0b00000000 << 1) | 1 = 0b00000001

# bit_index = 1
bVar2 = qr_matrix[1*29 + 0] = qr_matrix[29]  # Row0, Col1 = 0
uVar1 = (0b00000001 << 1) | 0 = 0b00000010

# bit_index = 2
bVar2 = qr_matrix[2*29 + 0] = qr_matrix[58]  # Row0, Col2 = 1
uVar1 = (0b00000010 << 1) | 1 = 0b00000101

# bit_index = 3
bVar2 = qr_matrix[3*29 + 0] = qr_matrix[87]  # Row0, Col3 = 1
uVar1 = (0b00000101 << 1) | 1 = 0b00001011

# bit_index = 4
bVar2 = qr_matrix[4*29 + 0] = qr_matrix[116] # Row0, Col4 = 0
uVar1 = (0b00001011 << 1) | 0 = 0b00010110

# bit_index = 5,6,7 (padding)
uVar1 = 0b10110000
```

### Ø®Ø±ÙˆØ¬ÛŒ

```c
sprintf(hex_output + 0*2, "%02x", 0xB0);
// hex_output[0..1] = "b0"
```

### Ù†Ù…ÙˆØ¯Ø§Ø± Bit Shifting

```
Initial: 00000000
Shift+OR 1: 00000001 (Col0)
Shift+OR 0: 00000010 (Col1)
Shift+OR 1: 00000101 (Col2)
Shift+OR 1: 00001011 (Col3)
Shift+OR 0: 00010110 (Col4)
Shift+OR 0: 00101100 (padding)
Shift+OR 0: 01011000 (padding)
Shift+OR 0: 10110000 (padding)
Final: 0xB0
```

## Ù…Ø«Ø§Ù„ Ú©Ø§Ù…Ù„ Ø¨Ø§ 3 Ø³Ø·Ø±

QR Matrix:

```
Col0 Col1 Col2 Col3 Col4
Row0: 1 0 1 1 0 â†’ 0xB0
Row1: 0 1 0 1 1 â†’ 0x58
Row2: 1 1 1 0 0 â†’ 0xE0
```

Ø®Ø±ÙˆØ¬ÛŒ:

```c
hex_output = "b058e0..."
```

## Ú†Ø±Ø§ TransposeØŸ

* Normal row-major: [Row0_Col0, Row0_Col1, â€¦]
* This algorithm: [Row0_Col0, Row1_Col0, â€¦, Row28_Col0]

**Ø¯Ù„ÛŒÙ„ Ø§Ø­ØªÙ…Ø§Ù„ÛŒ:**

* Ø§ÙØ²Ø§ÛŒØ´ Ù¾ÛŒÚ†ÛŒØ¯Ú¯ÛŒ reverse engineering
* Ø§ÛŒØ¬Ø§Ø¯ dependency Ø¨ÛŒÙ† Ø³Ø·Ø±Ù‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù
* Ø§Ù„Ú¯ÙˆÛŒ ØºÛŒØ±Ù…Ø¹Ù…ÙˆÙ„ Ø¯Ø§Ø¯Ù‡

## Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¯Ù‚ÛŒÙ‚ Indices

```c
index = bit_index * 29 + row
```

Ø¬Ø¯ÙˆÙ„ indices Ø¨Ø±Ø§ÛŒ row=0:

| bit_index | Ù…Ø­Ø§Ø³Ø¨Ù‡ | Index | Ù…ÙˆÙ‚Ø¹ÛŒØª     |
| --------- | ------ | ----- | ---------- |
| 0         | 0*29+0 | 0     | Row0, Col0 |
| 1         | 1*29+0 | 29    | Row0, Col1 |
| 2         | 2*29+0 | 58    | Row0, Col2 |
| 3         | 3*29+0 | 87    | Row0, Col3 |
| 4         | 4*29+0 | 116   | Row0, Col4 |
| 5         | -      | -     | Padding 0  |
| 6         | -      | -     | Padding 0  |
| 7         | -      | -     | Padding 0  |

```

### ØªØ³Øª Ø¨Ø§ Ø¯Ø§Ø¯Ù‡ ÙˆØ§Ù‚Ø¹ÛŒ
- ÙÙ‚Ø· 5 Ø³ØªÙˆÙ† Ø§ÙˆÙ„ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
- Every row produces: 0b10110000 = 0xB0
- Output: 29 repetitions of â€œb0â€ â†’ 58 chars

## Ù†Ú©Ø§Øª Ù…Ù‡Ù…
1. ÙÙ‚Ø· 5 Ø³ØªÙˆÙ† Ø§ÙˆÙ„ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ (145 Ù¾ÛŒÚ©Ø³Ù„ Ø§Ø² 841)
2. 3 Bit Padding: [Col0..Col4, 0,0,0]
3. Big-Endian Bit Order: Ø§ÙˆÙ„ÛŒÙ† bit Ø®ÙˆØ§Ù†Ø¯Ù‡ Ø´Ø¯Ù‡ â†’ MSB

```

ğŸ”¢ **Step 3: ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ Hex (ØªØ§Ø¨Ø¹ FUN_00101454)**

Ø§ÛŒÙ† Ù‚Ù„Ø¨ Ø§ØµÙ„ÛŒ Ø±Ù…Ø²Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø³Øª!

```c
void FUN_00101454(byte *qr_matrix, char *hex_output) {
    uint uVar1;
    byte bVar2;
    int row;
    int bit_index;
    
    for (row = 0; row < 29; row = row + 1) {
        uVar1 = 0;  // Ø¬Ù…Ø¹â€ŒÚ©Ù†Ù†Ø¯Ù‡ 8-bit
        
        for (bit_index = 0; bit_index < 8; bit_index = bit_index + 1) {
            if (bit_index < 5) {
                bVar2 = qr_matrix[bit_index * 29 + row];  // ØªÙˆØ¬Ù‡: transpose!
            }
            else {
                bVar2 = 0;  // padding Ø¨Ø§ 0
            }
            uVar1 = uVar1 << 1 | (uint)bVar2;
        }
        
        sprintf(hex_output + row * 2, "%02x", (ulong)uVar1);
    }
    
    hex_output[58] = '\0';
}
```

---

### ğŸ§  Ø¯Ø±Ú© Ø¹Ù…ÛŒÙ‚ Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ…

**Ù†Ú©ØªÙ‡ Ú©Ù„ÛŒØ¯ÛŒ: Transpose!**

```c
qr_matrix[bit_index * 29 + row]
```

Ø§ÛŒÙ† Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ Ø±Ø§ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù†Ø¯ØŒ Ù†Ù‡ Ø³Ø·Ø±Ù‡Ø§!

Ù…Ø¹Ø§Ø¯Ù„ Ø¯Ø± Ù¾Ø§ÛŒØªÙˆÙ†:

```python
value = qr_matrix[column][row]  # transpose of normal indexing
```

### ğŸ“ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ú©Ø§Ù…Ù„ Ø¨Ø§ Ù…Ø«Ø§Ù„

ÙØ±Ø¶ Ú©Ù†ÛŒÙ… Ø¨Ø®Ø´ Ú©ÙˆÚ†Ú©ÛŒ Ø§Ø² QR:

**QR Matrix (29Ã—29):**

|      | Col0 | Col1 | Col2 | Col3 | Col4 |
| ---- | ---- | ---- | ---- | ---- | ---- |
| Row0 | 1    | 0    | 1    | 1    | 0    |
| Row1 | 0    | 1    | 0    | 1    | 1    |
| Row2 | 1    | 1    | 1    | 0    | 0    |
| Row3 | 0    | 0    | 1    | 1    | 1    |
| Row4 | 1    | 1    | 0    | 0    | 1    |
| ...  | ...  | ...  | ...  | ...  | ...  |

Ù‡Ø± Ø±Ø¯ÛŒÙ Ø¨Ø§ 8 Ø¨ÛŒØª Ú¯Ø±ÙØªÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯: 5 Ø¨ÛŒØª Ø¯Ø§Ø¯Ù‡ + 3 Ø¨ÛŒØª padding.

---


### Ù¾Ø±Ø¯Ø§Ø²Ø´ Row 0 (FUN_00101454)

```python
row = 0
uVar1 = 0b00000000

# bit_index = 0
bVar2 = qr_matrix[0*29 + 0] = qr_matrix[0]   # Row0, Col0 = 1
uVar1 = (0b00000000 << 1) | 1 = 0b00000001

# bit_index = 1
bVar2 = qr_matrix[1*29 + 0] = qr_matrix[29]  # Row0, Col1 = 0
uVar1 = (0b00000001 << 1) | 0 = 0b00000010

# bit_index = 2
bVar2 = qr_matrix[2*29 + 0] = qr_matrix[58]  # Row0, Col2 = 1
uVar1 = (0b00000010 << 1) | 1 = 0b00000101

# bit_index = 3
bVar2 = qr_matrix[3*29 + 0] = qr_matrix[87]  # Row0, Col3 = 1
uVar1 = (0b00000101 << 1) | 1 = 0b00001011

# bit_index = 4
bVar2 = qr_matrix[4*29 + 0] = qr_matrix[116] # Row0, Col4 = 0
uVar1 = (0b00001011 << 1) | 0 = 0b00010110

# bit_index = 5 (padding)
bVar2 = 0
uVar1 = (0b00010110 << 1) | 0 = 0b00101100

# bit_index = 6 (padding)
bVar2 = 0
uVar1 = (0b00101100 << 1) | 0 = 0b01011000

# bit_index = 7 (padding)
bVar2 = 0
uVar1 = (0b01011000 << 1) | 0 = 0b10110000

# Ù†ØªÛŒØ¬Ù‡ Ù†Ù‡Ø§ÛŒÛŒ
uVar1 = 0b10110000 = 0xB0
```

### Ø®Ø±ÙˆØ¬ÛŒ

```c
sprintf(hex_output + 0*2, "%02x", 0xB0); // hex_output[0..1] = "b0"
```

### ğŸ”„ Ù†Ù…ÙˆØ¯Ø§Ø± Bit Shifting

```
Initial: 00000000
Shift+OR 1: 00000001 (read col0)
Shift+OR 0: 00000010 (read col1)
Shift+OR 1: 00000101 (read col2)
Shift+OR 1: 00001011 (read col3)
Shift+OR 0: 00010110 (read col4)
Shift+OR 0: 00101100 (padding)
Shift+OR 0: 01011000 (padding)
Shift+OR 0: 10110000 (padding)
^^^^^^^^
Final: 0xB0
```

**ØªØ±ØªÛŒØ¨ Bits:** MSB â† Col0, Col1, â€¦, Col4, 0, 0, 0 â†’ LSB
ğŸ“Š Ù…Ø«Ø§Ù„ Ú©Ø§Ù…Ù„ Ø¨Ø§ 3 Ø³Ø·Ø±

QR Matrix:

Col0 Col1 Col2 Col3 Col4
Row0: 1 0 1 1 0 â†’ 0b10110000 â†’ 0xB0
Row1: 0 1 0 1 1 â†’ 0b01011000 â†’ 0x58
Row2: 1 1 1 0 0 â†’ 0b11100000 â†’ 0xE0

Ø®Ø±ÙˆØ¬ÛŒ:

<img width="1039" height="543" alt="{55127C43-DDAF-425D-8D2E-29DED7CE1949}" src="https://github.com/user-attachments/assets/ff682dd7-250c-4686-bb8e-24e7795f00f9" />


ğŸ”¢ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¯Ù‚ÛŒÙ‚ Indices

```c
index = bit_index * 29 + row
```

Ø¬Ø¯ÙˆÙ„ indices Ø¨Ø±Ø§ÛŒ row=0:

| bit_index | Ù…Ø­Ø§Ø³Ø¨Ù‡ | Index | Ù…ÙˆÙ‚Ø¹ÛŒØª Ø¯Ø± Ù…Ø§ØªØ±ÛŒØ³ |
| --------- | ------ | ----- | ---------------- |
| 0         | 0Ã—29+0 | 0     | Row0, Col0       |
| 1         | 1Ã—29+0 | 29    | Row0, Col1       |
| 2         | 2Ã—29+0 | 58    | Row0, Col2       |
| 3         | 3Ã—29+0 | 87    | Row0, Col3       |
| 4         | 4Ã—29+0 | 116   | Row0, Col4       |
| 5         | -      | -     | Padding (0)      |
| 6         | -      | -     | Padding (0)      |
| 7         | -      | -     | Padding (0)      |

Ø¬Ø¯ÙˆÙ„ indices Ø¨Ø±Ø§ÛŒ row=5:

| bit_index | Ù…Ø­Ø§Ø³Ø¨Ù‡ | Index | Ù…ÙˆÙ‚Ø¹ÛŒØª     |
| --------- | ------ | ----- | ---------- |
| 0         | 0Ã—29+5 | 5     | Row5, Col0 |
| 1         | 1Ã—29+5 | 34    | Row5, Col1 |
| 2         | 2Ã—29+5 | 63    | Row5, Col2 |
| 3         | 3Ã—29+5 | 92    | Row5, Col3 |
| 4         | 4Ã—29+5 | 121   | Row5, Col4 |

ØªØ³Øª Ø¨Ø§ Ø¯Ø§Ø¯Ù‡ ÙˆØ§Ù‚Ø¹ÛŒ:
ÙØ±Ø¶ Ú©Ù†ÛŒÙ… 5 Ø³ØªÙˆÙ† Ø§ÙˆÙ„ ØªÙ…Ø§Ù… Ø³Ø·Ø±Ù‡Ø§:

All rows have: Col0=1, Col1=0, Col2=1, Col3=1, Col4=0

Every row produces: 0b10110000 = 0xB0

Output:
"b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0" (58 chars)
â””â”€ 29 repetitions of â€œb0â€

âš ï¸ Ù†Ú©Ø§Øª Ù…Ù‡Ù…:

1. ÙÙ‚Ø· 5 Ø³ØªÙˆÙ† Ø§ÙˆÙ„ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯:

   * 29Ã—29 matrix â†’ ÙÙ‚Ø· 29Ã—5 = 145 Ù¾ÛŒÚ©Ø³Ù„
   * Remaining 29Ã—24 = 696 Ù¾ÛŒÚ©Ø³Ù„ Ù†Ø§Ø¯ÛŒØ¯Ù‡ Ú¯Ø±ÙØªÙ‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯!
   * Ú†Ø±Ø§ØŸ Ø§Ø­ØªÙ…Ø§Ù„Ø§Ù‹:

     * Ú©Ø§Ù‡Ø´ Ø³Ø§ÛŒØ² Ø®Ø±ÙˆØ¬ÛŒ (58 char vs 212 char)
     * 5 Ø³ØªÙˆÙ† Ú©Ø§ÙÛŒ Ø¨Ø±Ø§ÛŒ encoding Ù…Ù†Ø­ØµØ± Ø¨ÙØ±Ø¯ Ø§Ø³Øª
     * Ø¨Ù‚ÛŒÙ‡ QR Ø¨Ø±Ø§ÛŒ error correction Ùˆ metadata

2. 3 Bit Padding:

   * 8 bits total: [Col0, Col1, Col2, Col3, Col4, 0, 0, 0]
     â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€
     Data (5 bits)  Padding (3 bits)
   * Ø§ÛŒÙ† Ø¨Ø§Ø¹Ø« Ù…ÛŒâ€ŒØ´ÙˆØ¯: Ù‡Ø± byte Ù‡Ù…ÛŒØ´Ù‡ bit Ù‡Ø§ÛŒ Ù¾Ø§ÛŒÛŒÙ† ØµÙØ± Ø¨Ø§Ø´Ø¯
   * Range Ù…Ù‚Ø§Ø¯ÛŒØ±: 0x00-0xF8 (Ù…Ø¶Ø±Ø¨ 8)

3. Big-Endian Bit Order:

```c
uVar1 = uVar1 << 1 | bVar2;
```

* Ø§ÙˆÙ„ÛŒÙ† bit Ø®ÙˆØ§Ù†Ø¯Ù‡ Ø´Ø¯Ù‡ â†’ MSB Ù…ÛŒâ€ŒØ´ÙˆØ¯.


# Ø±Ù…Ø²Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø±Ø­Ù„Ù‡ Ø¨Ù‡ Ù…Ø±Ø­Ù„Ù‡ Ø¨Ø±Ø§ÛŒ ASIS{test}

## ğŸ“Œ ÙˆØ±ÙˆØ¯ÛŒ Ø§ÙˆÙ„ÛŒÙ‡

```
ASIS{test}
```

* Ø·ÙˆÙ„: 10 Ú©Ø§Ø±Ø§Ú©ØªØ±

---

## Ù…Ø±Ø­Ù„Ù‡ 1: Padding

Ø·ÙˆÙ„ ÙˆØ±ÙˆØ¯ÛŒ: 10 Ú©Ø§Ø±Ø§Ú©ØªØ±

* Ù†ÛŒØ§Ø² Ø¨Ù‡ padding: 28 Ú©Ø§Ø±Ø§Ú©ØªØ± (Ø¨Ø±Ø§ÛŒ Ø±Ø³ÛŒØ¯Ù† Ø¨Ù‡ 38)
* Ù…ÙˆÙ‚Ø¹ÛŒØª Ø´Ø±ÙˆØ¹ padding: 10
* Ø§Ù„Ú¯ÙˆÛŒ padding Ø¨Ø± Ø§Ø³Ø§Ø³ `index mod 3`:

  * 1 â†’ `+`
  * 2 â†’ `-`
  * 0 â†’ `*`

### Ù…Ø±Ø§Ø­Ù„

```
Ù…ÙˆÙ‚Ø¹ÛŒØª 10: 10 mod 3 = 1 â†’ +
Ù…ÙˆÙ‚Ø¹ÛŒØª 11: 11 mod 3 = 2 â†’ -
Ù…ÙˆÙ‚Ø¹ÛŒØª 12: 12 mod 3 = 0 â†’ *
Ù…ÙˆÙ‚Ø¹ÛŒØª 13: 13 mod 3 = 1 â†’ +
```

... Ø§Ø¯Ø§Ù…Ù‡ ØªØ§ Ù…ÙˆÙ‚Ø¹ÛŒØª 37

### Ø®Ø±ÙˆØ¬ÛŒ Ø¨Ø¹Ø¯ Ø§Ø² Padding

```
ASIS{test}+-*+-*+-*+-*+-*+-*+-*+-*+-*+-*-
```

* Ø·ÙˆÙ„: 38 Ú©Ø§Ø±Ø§Ú©ØªØ±

---

## Ù…Ø±Ø­Ù„Ù‡ 2: ØªÙˆÙ„ÛŒØ¯ QR Code

* ÙˆØ±ÙˆØ¯ÛŒ: `ASIS{test}+-*+-*+-*+-*+-*+-*+-*+-*+-*+-*-`
* ØªÙ†Ø¸ÛŒÙ…Ø§Øª: ECLevel=L, Mode=8-bit
* Ø®Ø±ÙˆØ¬ÛŒ: Ù…Ø§ØªØ±ÛŒØ³ Ø¨Ø§ÛŒÙ†Ø±ÛŒ 29Ã—29

### Ù†Ù…ÙˆÙ†Ù‡ Ù…Ø§ØªØ±ÛŒØ³ (5 Ø³Ø·Ø± Ø§ÙˆÙ„ Ø§Ø² 29)

```
[1,1,1,1,1,1,1,0,1,0,1,0,0,1,0,1,1,1,1,1,1,1,1,0,1,0,1,1,0]
[1,0,0,0,0,0,1,0,0,1,0,1,1,0,1,0,1,0,0,0,0,0,1,0,0,1,1,0,1]
[1,0,1,1,1,0,1,0,1,0,1,0,1,1,0,1,0,0,1,1,1,0,1,0,1,0,0,1,0]
[1,0,1,1,1,0,1,0,1,1,0,1,0,0,1,0,1,0,1,1,1,0,1,0,1,1,1,0,1]
[1,0,1,1,1,0,1,0,0,1,1,1,0,1,1,1,0,0,1,1,1,0,1,0,0,0,1,1,0]
```

... (24 Ø³Ø·Ø± Ø¯ÛŒÚ¯Ø±)

---

## Ù…Ø±Ø­Ù„Ù‡ 3: ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ Hex (Ø®ÙˆØ§Ù†Ø¯Ù† Ø³ØªÙˆÙ†ÛŒ)

### Ù†Ù…ÙˆÙ†Ù‡ Ù…Ø­Ø§Ø³Ø¨Ø§Øª

* Ø³ØªÙˆÙ† 0 (5 Ø¨ÛŒØª Ø§ÙˆÙ„): `[1,1,1,1,1]` â†’ `0b11111000` â†’ 248 â†’ `0xF8`
* Ø³ØªÙˆÙ† 1 (5 Ø¨ÛŒØª Ø§ÙˆÙ„): `[1,0,0,0,0]` â†’ `0b10000000` â†’ 128 â†’ `0x80`
* Ø³ØªÙˆÙ† 2 (5 Ø¨ÛŒØª Ø§ÙˆÙ„): `[1,0,1,1,1]` â†’ `0b11011000` â†’ 216 â†’ `0xD8`

### Ø®Ø±ÙˆØ¬ÛŒ Ù…Ø±Ø­Ù„Ù‡ 3 (ÙØ±Ø¶ÛŒ)

```
f880d8f8f840a8604050d8a8f8f840f840a850f0d8a050d8e8f860
```

* Ø·ÙˆÙ„: 58 Ú©Ø§Ø±Ø§Ú©ØªØ± (29 Ø¨Ø§ÛŒØª Ã— 2)

---

## Ù…Ø±Ø­Ù„Ù‡ 4: Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Prefix

* Prefix ØªØµØ§Ø¯ÙÛŒ ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯Ù‡ Ø§Ø² seed Ø¨Ø± Ø§Ø³Ø§Ø³ Ø²Ù…Ø§Ù†:

```
Ky7Xm2Qp9Vs1L
```

* Ø·ÙˆÙ„: 14 Ú©Ø§Ø±Ø§Ú©ØªØ±

### Ø®Ø±ÙˆØ¬ÛŒ Ù†Ù‡Ø§ÛŒÛŒ

```
Ky7Xm2Qp9Vs1Lf880d8f8f840a8604050d8a8f8f840f840a850f0d8a050d8e8f860
```

* Ø·ÙˆÙ„: 72 Ú©Ø§Ø±Ø§Ú©ØªØ±

---

## ğŸ“ Ø®Ù„Ø§ØµÙ‡ Ù†Ù‡Ø§ÛŒÛŒ

| Ù…Ø±Ø­Ù„Ù‡          | Ø®Ø±ÙˆØ¬ÛŒ                                                               | Ø·ÙˆÙ„ |
| -------------- | ------------------------------------------------------------------- | --- |
| ÙˆØ±ÙˆØ¯ÛŒ          | ASIS{test}                                                          | 10  |
| Ø¨Ø¹Ø¯ Ø§Ø² Padding | ASIS{test}+-*+-*+-*+-*+-*+-*+-*+-*+-*+-*-                           | 38  |
| Ø¨Ø¹Ø¯ Ø§Ø² QR      | Ù…Ø§ØªØ±ÛŒØ³ 29Ã—29 Ø¨Ø§ÛŒÙ†Ø±ÛŒ                                                 | -   |
| Ø¨Ø¹Ø¯ Ø§Ø² Hex     | f880d8f8f840a8604050d8a8f8f840f840a850f0d8a050d8e8f860              | 58  |
| Ø®Ø±ÙˆØ¬ÛŒ Ù†Ù‡Ø§ÛŒÛŒ    | Ky7Xm2Qp9Vs1Lf880d8f8f840a8604050d8a8f8f840f840a850f0d8a050d8e8f860 | 72  |

âš ï¸ ØªÙˆØ¬Ù‡: Ù…Ù‚Ø§Ø¯ÛŒØ± Hex Ùˆ Prefix Ø¯Ø± Ø¨Ø§Ù„Ø§ ÙØ±Ø¶ÛŒ Ù‡Ø³ØªÙ†Ø¯. Ø¨Ø±Ø§ÛŒ Ø¯Ø§Ø¯Ù‡ ÙˆØ§Ù‚Ø¹ÛŒ Ø¨Ø§ÛŒØ¯ Ú©Ø¯ Ø¨Ø§ Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ `libqrencode` Ø§Ø¬Ø±Ø§ Ø´ÙˆØ¯.





# ğŸ“‹ Ù…Ø±Ø§Ø­Ù„ Ø­Ù„ Ú†Ø§Ù„Ø´ QR Code CTF

## Ù…Ø±Ø­Ù„Ù‡ 1: ØªØ­Ù„ÛŒÙ„ Ø¨Ø§ÛŒÙ†Ø±ÛŒ (Reverse Engineering)

Ø§Ø¨ØªØ¯Ø§ Ø¨Ø§ÛŒØ¯ ÙØ§ÛŒÙ„ Ø§Ø¬Ø±Ø§ÛŒÛŒ Ø±Ø§ Ø¨Ø§ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ù…Ù‡Ù†Ø¯Ø³ÛŒ Ù…Ø¹Ú©ÙˆØ³ ØªØ­Ù„ÛŒÙ„ Ú©Ù†ÛŒÙ…:

```bash
# Ø¨Ø±Ø±Ø³ÛŒ Ù†ÙˆØ¹ ÙØ§ÛŒÙ„
file challenge

# Ø¯ÛŒØ³â€ŒØ§Ø³Ù…Ø¨Ù„ Ú©Ø±Ø¯Ù†
objdump -d challenge > disassembly.txt

# ÛŒØ§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ghidra/IDA Pro
```

Ú†ÛŒØ²Ù‡Ø§ÛŒÛŒ Ú©Ù‡ Ø¨Ø§ÛŒØ¯ Ù¾ÛŒØ¯Ø§ Ú©Ù†ÛŒÙ…:

* âœ… ØªØ§Ø¨Ø¹ padding (`processEntry`) Ùˆ Ø§Ù„Ú¯ÙˆÛŒ `+-*`
* âœ… Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² `libqrencode` Ø¨Ø±Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ QR
* âœ… Ù†Ø­ÙˆÙ‡ ØªØ¨Ø¯ÛŒÙ„ Ù…Ø§ØªØ±ÛŒØ³ QR Ø¨Ù‡ hex (Ø®ÙˆØ§Ù†Ø¯Ù† Ø³ØªÙˆÙ†ÛŒ)
* âœ… Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù† 14 Ú©Ø§Ø±Ø§Ú©ØªØ± prefix ØªØµØ§Ø¯ÙÛŒ

---

## Ù…Ø±Ø­Ù„Ù‡ 2: Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ ÙØ±Ù…Øª Ø¯Ø§Ø¯Ù‡

Ø§Ø² ØªØ­Ù„ÛŒÙ„ Ú©Ø¯ Ù…ØªÙˆØ¬Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÛŒÙ…:

```
Ø®Ø±ÙˆØ¬ÛŒ = [14 char random] + [hex Ø§Ø² QR code]
```

* Prefix 14 Ú©Ø§Ø±Ø§Ú©ØªØ±ÛŒ ØªØµØ§Ø¯ÙÛŒ Ø¨Ø§ÛŒØ¯ Ø­Ø°Ù Ø´ÙˆØ¯.
* QR Code Ø§Ø² Ù†ÙˆØ¹ Version 3 Ø§Ø³Øª (Ø³Ø§ÛŒØ² 29Ã—29)
* Ø¯Ø§Ø¯Ù‡ Ø¨Ù‡ ØµÙˆØ±Øª 4 Ø¨Ø§ÛŒØª Ø¯Ø± Ù‡Ø± Ø³Ø·Ø± Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡ (29 Ø³Ø·Ø± Ã— 4 = 116 Ø¨Ø§ÛŒØª = 232 Ú©Ø§Ø±Ø§Ú©ØªØ± hex)
* Ø®ÙˆØ§Ù†Ø¯Ù† Ø¯Ø§Ø¯Ù‡: Ø³Ø·Ø± Ø¨Ù‡ Ø³Ø·Ø±ØŒ Ø§Ø² MSB Ø¨Ù‡ LSB

---

## Ù…Ø±Ø­Ù„Ù‡ 3: Ù†ÙˆØ´ØªÙ† Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø¯ÛŒÚ©Ø¯Ø±

Ø¨Ø±Ø¹Ú©Ø³ ÙØ±Ø¢ÛŒÙ†Ø¯ encode Ø±Ø§ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…:

```python
from PIL import Image
from pyzbar.pyzbar import decode

def decode_ctf_qr(output_path):
    # â”€â”€ Ú¯Ø§Ù… 1: Ø®ÙˆØ§Ù†Ø¯Ù† ÙØ§ÛŒÙ„ Ø®Ø±ÙˆØ¬ÛŒ â”€â”€
    hexstr = open(output_path, 'r').read().strip()
    print(f"[+] Ø±Ø´ØªÙ‡ Ú©Ø§Ù…Ù„: {hexstr[:50]}... (Ø·ÙˆÙ„: {len(hexstr)})")

    # â”€â”€ Ú¯Ø§Ù… 2: Ø­Ø°Ù 14 Ú©Ø§Ø±Ø§Ú©ØªØ± prefix â”€â”€
    prefix = hexstr[:14]
    hex_cipher = hexstr[14:]
    print(f"[+] Prefix: {prefix}")
    print(f"[+] Hex cipher: {hex_cipher[:50]}... (Ø·ÙˆÙ„: {len(hex_cipher)})")

    # â”€â”€ Ú¯Ø§Ù… 3: ØªØ¨Ø¯ÛŒÙ„ hex Ø¨Ù‡ Ø¨Ø§ÛŒØª â”€â”€
    data = bytes.fromhex(hex_cipher)
    print(f"[+] ØªØ¹Ø¯Ø§Ø¯ Ø¨Ø§ÛŒØªâ€ŒÙ‡Ø§: {len(data)} (Ø§Ù†ØªØ¸Ø§Ø±: 116)")

    # â”€â”€ Ú¯Ø§Ù… 4: Ø¨Ø§Ø²Ø³Ø§Ø²ÛŒ Ù…Ø§ØªØ±ÛŒØ³ 29Ã—29 QR â”€â”€
    size = 29
    matrix = [[0]*size for _ in range(size)]
    for row in range(size):
        for k in range(4):  # Ù‡Ø± Ø³Ø·Ø± 4 Ø¨Ø§ÛŒØª
            byte_index = row * 4 + k
            byte = data[byte_index]
            for b in range(8):  # MSB â†’ LSB
                col = k * 8 + b
                if col < size:
                    bit = (byte >> (7 - b)) & 1
                    matrix[row][col] = bit
    print(f"[+] Ù…Ø§ØªØ±ÛŒØ³ {size}Ã—{size} Ø¨Ø§Ø²Ø³Ø§Ø²ÛŒ Ø´Ø¯")

    # â”€â”€ Ú¯Ø§Ù… 5: ØªØ¨Ø¯ÛŒÙ„ Ù…Ø§ØªØ±ÛŒØ³ Ø¨Ù‡ ØªØµÙˆÛŒØ± PNG â”€â”€
    scale = 10
    img = Image.new('RGB', (size*scale, size*scale), 'white')
    pixels = img.load()
    for y in range(size):
        for x in range(size):
            color = 0 if matrix[y][x] == 1 else 255
            for dy in range(scale):
                for dx in range(scale):
                    pixels[x*scale+dx, y*scale+dy] = (color, color, color)
    img.save('reconstructed_qr.png')
    print("[+] ØªØµÙˆÛŒØ± QR Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯: reconstructed_qr.png")

    # â”€â”€ Ú¯Ø§Ù… 6: Ø§Ø³Ú©Ù† Ùˆ Ø¯ÛŒÚ©Ø¯ QR Code â”€â”€
    decoded = decode(img)
    if decoded:
        text = decoded[0].data.decode('utf-8')
        print(f"\nğŸ‰ FLAG: {text}")
        return text
    else:
        print("âŒ QR code Ø®ÙˆØ§Ù†Ø¯Ù‡ Ù†Ø´Ø¯!")
        return None

if __name__ == '__main__':
    decode_ctf_qr('output.txt')
```

---

## ğŸ” ØªØ­Ù„ÛŒÙ„ Ø¯Ù‚ÛŒÙ‚â€ŒØªØ± Ù‡Ø± Ø¨Ø®Ø´

1. **Ú†Ø±Ø§ 14 Ú©Ø§Ø±Ø§Ú©ØªØ± Ø§ÙˆÙ„ Ø±Ø§ Ø­Ø°Ù Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…ØŸ**

```c
// Ø¯Ø± Ú©Ø¯ Ø§ØµÙ„ÛŒ:
char prefix[15];
generate_random_prefix(prefix, 14);
strcat(output, prefix);
```

* ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Ø³Ø±Ø¯Ø±Ú¯Ù…ÛŒ Ø§Ø³Øª Ùˆ Ø§Ø·Ù„Ø§Ø¹Ø§ØªÛŒ Ù†Ø¯Ø§Ø±Ø¯.

2. **Ú†Ø±Ø§ 116 Ø¨Ø§ÛŒØªØŸ**

* Ù…Ø§ØªØ±ÛŒØ³ QR = 29Ã—29 Ø¨ÛŒØª
* Ù‡Ø± Ø³Ø·Ø± = 29 Ø¨ÛŒØª â†’ Ù†ÛŒØ§Ø² Ø¨Ù‡ 4 Ø¨Ø§ÛŒØª (32 Ø¨ÛŒØª)
* Ú©Ù„ Ø¯Ø§Ø¯Ù‡ = 29Ã—4 = 116 Ø¨Ø§ÛŒØª

3. **Ú†Ø±Ø§ Ø®ÙˆØ§Ù†Ø¯Ù† MSB-firstØŸ**

```python
bit = (byte >> (7 - b)) & 1
```

* Ù…Ø·Ø§Ø¨Ù‚ Ø¨Ø§ Ù†Ø­ÙˆÙ‡ encode Ø§ØµÙ„ÛŒ.

4. **Ú†Ø±Ø§ scale = 10ØŸ**

* Ø¨Ø±Ø§ÛŒ Ù‚Ø§Ø¨Ù„ Ø§Ø³Ú©Ù† Ø´Ø¯Ù† QR code ØªÙˆØ³Ø· pyzbar.

---

## ğŸš€ Ø§Ø¬Ø±Ø§ÛŒ Ù†Ù‡Ø§ÛŒÛŒ

```bash
# Ù†ØµØ¨ Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡â€ŒÙ‡Ø§
pip install pillow pyzbar

# Ø§Ø¬Ø±Ø§
python decode_qr.py
```
